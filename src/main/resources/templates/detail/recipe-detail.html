<!doctype html>
<html lang="ko">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head" th:replace="~{common/layout :: head}"></head>

<head>


  <meta charset="utf-8" />
  <title>smore | recipe-detail</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content=" " />
  <meta name="keywords" content="" />
  <meta content="Themesdesign" name="author" />

  <!-- App favicon -->
  <link rel="shortcut icon" th:href="@{/images/favicon.ico}">

  <!-- Choise Css -->
  <link rel="stylesheet" th:href="@{/libs/choices.js/public/assets/styles/choices.min.css}">

  <!-- Light Box Css -->
  <link rel="stylesheet" th:href="@{/libs/glightbox/css/glightbox.min.css}">

  <!-- Bootstrap Css -->
  <link th:href="@{/css/bootstrap.min.css}" id="bootstrap-style" rel="stylesheet" type="text/css" />
  <!-- Icons Css -->
  <link th:href="@{/css/icons.min.css}" rel="stylesheet" type="text/css" />
  <!-- App Css-->
  <link th:href="@{/css/app.min.css}" id="app-style" rel="stylesheet" type="text/css" />
  <!--Custom Css-->
  <link th:href="@{/css/receipe-detail.css}" id="app-style" rel="stylesheet" type="text/css" />
  <!--recipe-detail Css-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>

<body>
<header th:replace="~{common/layout :: #header}"></header>

  <!--start page Loader -->
  <div id="preloader">
    <div id="status">
      <ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </div>
  </div>
  <!--end page Loader -->
  

  <div class="main-content">

    <div class="page-content">

      <!-- Start home -->
      <section class="page-title-box" style="background-image: linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ), url(/images/img/hero_recipe-detail.jpg); height: 350px; padding-top: 130px; background-position: center;">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-md-6">
              <div class="text-center text-white">
                <h3 class="mb-4 hero-title" style="font-weight: 400;">레시피</h3>
                <div class="page-next">
                  <nav class="d-inline-block" aria-label="breadcrumb text-center">
                    <ol class="breadcrumb justify-content-center">
                      <li class="breadcrumb-item"><a tH:href="@{/}">HOME</a></li>
                      <li class="breadcrumb-item"><a th:href="@{/category/recipe}">LIFE</a></li>
                      <li class="breadcrumb-item"><a th:href="@{/category/recipe}">RECIPE</a></li>
                      <li class="breadcrumb-item active" aria-current="page"> RECIPE DETAIL </li>
                    </ol>
                  </nav>
                </div>
              </div>
            </div>
            <!--end col-->
          </div>
          <!--end row-->
        </div>
        <!--end container-->
      </section>
      <!-- end home -->

      <!-- START SHAPE -->
      <div class="position-relative" style="z-index: 1">
        <div class="shape">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 250">
            <path fill="#FFFFFF" fill-opacity="1"
              d="M0,192L120,202.7C240,213,480,235,720,234.7C960,235,1200,213,1320,202.7L1440,192L1440,320L1320,320C1200,320,960,320,720,320C480,320,240,320,120,320L0,320Z">
            </path>
          </svg>
        </div>
      </div>
      <!-- END SHAPE -->

      <!-- START CANDIDATE-DETAILS -->
      <section class="section">
        <div class="container">
          <div class="text-center my-5">
            <p class="text-primary" >[[${recipe.rcpPat2}]] • [[${recipe.rcpWay2}]]</p>
            <h2>[[${recipe.rcpNm}]]</h2>
          </div>
          <hr>
          <div class="row">
            <div class="col">
              <div class="mt-4 mt-lg-0">
                <div class="p-4 candidate-personal-detail">
                  <div> <!--재료 시작-->
                    <h4 class="fw-semibold mb-3">재료</h4>
                    <p class="text-muted mb-2">[[${recipe.rcpPartsDtls}]]</p>
                  </div> <!--재료 끝-->
                  <div class="candidate-portfolio mt-5 pt-3"> <!--조리방법 시작-->
                    <h4 class="fw-semibold mb-0">조리방법</h4>
                    <div class="row">
                    
                      <!--조리방법 백엔드 시작-->
                      <th:block th:if="${recipe.manual01} != null">
                      <div class="col-lg-4 mt-4 mb-3">
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg01}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual01}]]</p>
                        </div>
                      </div>
                      <th:block>
                      <th:block th:if="${recipe.manual02} != null">
                      <div class="col-lg-4 mt-4 mb-3">
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg02}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual02}]]</p>
                        </div>
                      </div>
                      <th:block>
                      <th:block th:if="${recipe.manual03} != null">
                      <div class="col-lg-4 mt-4 mb-3">
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg03}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual03}]]</p>
                        </div>
                      </div>
                      <th:block>
                      <th:block th:if="${recipe.manual04} != null">
                      <div class="col-lg-4 mt-4 mb-3"> 
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg04}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual04}]]</p>
                        </div>
                      </div>
                      <th:block>
                      <th:block th:if="${recipe.manual05} != null">
                      <div class="col-lg-4 mt-4 mb-3">
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg05}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual05}]]</p>
                        </div>
                      </div>
                      <th:block>
                      <th:block th:if="${recipe.manual06} != null">
                      <div class="col-lg-4 mt-4 mb-3">
                        <div class="candidate-portfolio-box card border-0" style="pointer-events: none;">
                          <img th:src="${recipe.manualImg06}" class="img-fluid rounded-3">
                          <p class="text-muted mb-2 mt-2">[[${recipe.manual06}]]</p>
                        </div>
                      </div>
                      <th:block>
                      
                      <!--조리방법 백엔드 끝-->
                      
                    </div>
                  </div><!--end candidate-portfolio-->
                  <div class="candidate-portfolio mt-4 pt-3">
                    <div class="row">
                      <h4 class="fw-semibold mb-0">완성</h4>
                      <div class="col-lg-5 mt-4">
                        <div class="border-0">
                          <img th:src="${recipe.attFileNoMain}" class="img-fluid rounded-3"
                            style="width: 400px; height: 360px;">
                        </div>
                      </div>
                      <div class="card-body card col-lg-7 mt-4 m-auto" style="height: 360px;">
                        <div class="row">
                          <h5 class="col-lg-12 px-4 py-1 mb-4 fw-semibold">영양성분</h5>
                          <div class="col-lg-12 mb-3 px-4 border-bottom">
                            <p class="d-inline">열량</p>
                            <p class="d-inline float-end">[[${recipe.infoEng}]] kcal</p>
                          </div>
                          <div class="col-lg-12 mb-3 px-4 border-bottom">
                            <p class="d-inline">탄수화물</p>
                            <p class="d-inline float-end">[[${recipe.infoCar}]]g</p>
                          </div>
                          <div class="col-lg-12 mb-3 px-4 border-bottom">
                            <p class="d-inline">단백질</p>
                            <p class="d-inline float-end">[[${recipe.infoPro}]]g</p>
                          </div>
                          <div class="col-lg-12 mb-3 px-4 border-bottom">
                            <p class="d-inline">지방</p>
                            <p class="d-inline float-end">[[${recipe.infoFat}]]g</p>
                          </div>
                          <div class="col-lg-12 px-4">
                            <p class="d-inline">나트륨</p>
                            <p class="d-inline float-end">[[${recipe.infoNa}]]mg</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- 좋아요, 스크랩 시작 -->
				<div class="col-lg-12 text-center mt-5">
                	<a th:id="|clip${recipe.rcpNo}|" th:value="${recipe.isClip}" th:onclick="|onClip(${recipe.rcpNo});|"
  					class="heart btn btn-soft-warning bg-soft-warning" name="clip">
  						<i class="uil uil-heart-alt ms-1" name="clipOff"></i> 스크랩
  					</a>
                     <a th:id="|like${recipe.rcpNo}|" th:value="${recipe.isLike}" th:onclick="|onLike('${recipe.rcpNo}');|"
  					class="heart btn btn-soft-warning bg-soft-warning" name="like">
  						<i class="uil uil-thumbs-up ms-1"></i> 좋아요 [[${recipe.likeCount}]]
  					</a>
             	</div>
                  <!-- 좋아요, 스크랩 끝 -->
                  
                  <!--댓글부 시작-->
                  <div class="mt-5 pt-5">
                    <div class="mb-3">
                      <h4>댓글</h4>
                      <hr>
                    </div>
                    <!--댓글 백엔드 시작-->
                    <th:block th:if="${replyList != null}">
                    	<th:block  th:each="reply : ${replyList}"> 
		                    <div class="d-sm-flex align-items-top mt-4">
		                      <div class="flex-shrink-0">
		                        <img class="rounded-circle avatar-md img-thumbnail" th:src="@{/images/user/img-01.jpg}"
		                          alt="img">
		                      </div>
		                      <div class="flex-grow-1 ms-sm-3">
		                        <div class="row">
		                        	<h6 class="col-lg-9 mt-3 mb-1" >[[${reply.writer}]]</h6>
		                          <th:block th:if="${session.loginMember != null && 
									(session.loginMember.id == reply.writer || session.loginMember.role == 'ROLE_ADMIN')}">
		                         	<div class="col-lg-3 text-end">
		                            	<button name="update" th:id="|updateBtn${reply.rcprNo}|" class="btn btn-primary btn-hover"
		                            	th:onclick="|updateReply(${reply.rcprNo})|">수정</button>
		                            	<button name="delete" class="btn btn-primary btn-hover" 
		                            	th:onclick="|deleteReply(${reply.rcprNo},${recipe.rcpNo});|">삭제</button>
		                          	</div>
		                          </th:block>
		                          <p class="col-lg-4 text-muted">[[${#dates.format(reply.modifyDate)}]]</p>
		                          <p class="text-muted" th:id="|content${reply.rcprNo}|">[[${reply.content}]]</p>
		                          <div class="mt-1 pt-3 mb-3 updateReply" th:id="|updateReply${reply.rcprNo}|" style="display: none">
	                        		<div class="row">
					                  <div class="col-lg-12">
					                    <div class="mb-3">
					                      <input type="hidden" name="rcpNo" th:value="${recipe.rcpNo}" />
					                      <textarea class="form-control" th:id="|inputReply${reply.rcprNo}|" name="content" rows="3"
					                        placeholder="내용을 입력해주세요." required>[[${reply.content}]]</textarea>
					                    </div>
					                  </div><!--end col-->
					                </div><!--end row-->
					                <div class="text-end">
					                  <button id="submit" class="btn btn-primary btn-hover" 
					                  th:onclick="|backBtn(${reply.rcprNo})|">취소</button>
					                  <button type="submit" id="submit" class="btn btn-primary btn-hover" 
					                  th:onclick="|updBtn(${reply.rcprNo}, ${recipe.rcpNo})|">확인</button>
					                </div>
		                          </div>
		                        </div>
		                      </div>
		                    </div>
		            	</th:block>   
                    </th:block>
                    <!--댓글 백엔드 끝-->
                  </div>
                  <th:block th:if="${session.loginMember != null}">
                  <form th:action="@{recipe/reply}" method="post" class="mt-5 pt-3 mb-3"> <!--댓글 폼 시작-->
                    <div class="row">
                      <div class="col-lg-12">
                        <div class="mb-3">
                          <h4>댓글 작성</h4>
                          <hr />
                          <input type="hidden" name="rcpNo" th:value="${recipe.rcpNo}" />
                          <textarea class="form-control" id="inputcoment" name="content" rows="3"
                            placeholder="내용을 입력해주세요." required></textarea>
                        </div>
                      </div><!--end col-->
                    </div><!--end row-->
                    <div class="text-end">
                      <button name="submit" type="submit" id="submit" class="btn btn-primary btn-hover">등록하기 <i
                        class="uil uil-message ms-1"></i></button>
                    </div>
                  </form> <!--댓글 폼 끝-->
                   </th:block>
                  <!--댓글 백엔드 끝-->

                </div><!--end card-body-->
              </div><!--end card-->
            </div><!--end col-->
          </div><!--end row-->
        </div><!--end container-->
      </section>
      <!-- END CANDIDATE-DETAILS -->

    </div>
    <!-- End Page-content -->

    <!-- Style switcher -->
  <div id="style-switcher" onclick="toggleSwitcher()" style="left: -165px;">
    <div>
      <div class="mt-3">
        <div class="text-center mt-3">
          <!-- light-dark mode -->
          <a href="javascript: void(0);" id="mode" class="mode-btn text-white rounded-3">
            <i class="uil uil-brightness mode-dark mx-auto"></i>
            <i class="uil uil-moon mode-light"></i>
          </a>
          <!-- END light-dark Mode -->
        </div>
      </div>
    </div>
    <div class="bottom d-none d-md-block">
    </div>
  </div>
  <!-- end switcher-->

  <!--start back-to-top-->
  <button onclick="topFunction()" id="back-to-top">
    <i class="mdi mdi-arrow-up"></i>
  </button>
  <!--end back-to-top-->
  </div>
  <!-- end main content-->

  </div>
  <!-- END layout-wrapper -->
  
  <script type="text/javascript">
  	function deleteReply(rcprNo, rcpNo){
			var url = "/recipe/replyDel?rcprNo=";
			var requestURL = url + rcprNo +"&rcpNo=" + rcpNo;
			location.replace(requestURL);
	}
  	
  	function updateReply(rcprNo){
  		var updateBtn = document.getElementById("updateBtn" + rcprNo);
  		updateBtn.style.display = "none";
  		
  		var content = document.getElementById("content" + rcprNo);
  		content.style.display = "none";
  		
  		var updateForm = document.getElementById("updateReply" +rcprNo);
  		updateForm.style.display = "inline-block";
  	}
  	
  	function updBtn(rcprNo, rcpNo){
  		var newContent = document.getElementById("inputReply" + rcprNo).value;
  		if(newContent.trim() === ''){
  			alert("내용을 입력해주세요.")
  			return;
  		}
  		
  		var requestURL = '/recipe/updateReply?rcprNo=' + rcprNo +'&content=' + newContent + '&rcpNo=' + rcpNo;
  		location.replace(requestURL);
  	}
  	
  	function backBtn(rcprNo){
  		var updateBtn = document.getElementById("updateBtn" + rcprNo);
  		updateBtn.style.display = "inline-block";
  		
  		var content = document.getElementById("content" + rcprNo);
  		content.style.display = "inline-block";
  		
  		var updateForm = document.getElementById("updateReply" +rcprNo);
  		updateForm.style.display = "none";
  	}
  </script>
  
  <footer th:replace="~{common/layout :: #footer}"></footer>

  <!-- JAVASCRIPT -->
  <script th:src="@{/libs/bootstrap/js/bootstrap.bundle.min.js}"></script>
  <script src="https://unicons.iconscout.com/release/v4.0.0/script/monochrome/bundle.js"></script>


  <!-- Choice Js -->
  <script th:src="@{/libs/choices.js/public/assets/scripts/choices.min.js}"></script>

  <!-- Light Box Js -->
  <script th:src="@{/libs/glightbox/js/glightbox.min.js}"></script>

  <script th:src="@{/js/pages/lightbox.init.js}"></script>

  <!-- Switcher Js -->
  <script th:src="@{/js/pages/switcher.init.js}"></script>

  <script th:src="@{/js/app.js}"></script>

</body>

</html>